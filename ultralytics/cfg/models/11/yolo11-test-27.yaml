# Ultralytics YOLO ðŸš€, AGPL-3.0
# YOLO12 POWER: Optimized Triplet + BiFPN (No P2)

nc: 80
scales:
  n: [0.50, 0.25, 1024]
  s: [0.50, 0.50, 1024]
  m: [0.50, 1.00, 512]
  l: [1.00, 1.00, 512]
  x: [1.00, 1.50, 512]

backbone:
  - [-1, 1, Conv, [64, 3, 2]]             # 0
  - [-1, 1, Conv, [128, 3, 2]]            # 1
  - [-1, 2, C3k2, [256, False, 0.25]]     # 2
  - [-1, 1, Conv, [256, 3, 2]]            # 3
  - [-1, 2, C3k2, [512, False, 0.25]]     # 4
  - [-1, 1, Conv, [512, 3, 2]]            # 5
  - [-1, 2, C3k2, [512, True]]            # 6
  - [-1, 1, Conv, [1024, 3, 2]]           # 7
  - [-1, 2, C3k2, [1024, True]]           # 8
  - [-1, 1, SPPF, [1024, 5]]              # 9
  # P5 Output
  - [-1, 1, TripletAttention, []]         # 10

head:
  # === Top-down (FPN) ===
  # Tá»« P5 xuá»‘ng P4
  - [-1, 1, nn.Upsample, [None, 2, "nearest"]]   # 11
  - [[-1, 6], 1, BiFPN, [256]]                   # 12 (Há»£p nháº¥t vá»›i Backbone P4 layer 6)
  - [-1, 2, C3k2, [256, False]]                  # 13 (Output P4 Top-down)

  # Tá»« P4 xuá»‘ng P3
  - [-1, 1, nn.Upsample, [None, 2, "nearest"]]   # 14
  - [[-1, 4], 1, BiFPN, [256]]                   # 15 (Há»£p nháº¥t vá»›i Backbone P3 layer 4)
  - [-1, 2, C3k2, [256, False]]                  # 16
  - [-1, 1, CoordAtt, []]                        # 17 -> Detect P3 (Small objects)
  # (ÄÃ£ dá»«ng láº¡i á»Ÿ P3, khÃ´ng xuá»‘ng P2 ná»¯a)

  # === Bottom-up (PANet) ===
  # Tá»« P3 lÃªn P4
  - [-1, 1, Conv, [256, 3, 2]]                   # 18 (Input tá»« layer 17)
  - [[-1, 6, 13], 1, BiFPN, [256]]               # 19 (Há»£p nháº¥t: P3-up, Backbone P4, P4 Top-down)
  - [-1, 4, C3k2, [512, False]]                  # 20
  - [-1, 1, CoordAtt, []]                        # 21 -> Detect P4 (Medium objects)

  # Tá»« P4 lÃªn P5
  - [-1, 1, Conv, [512, 3, 2]]                   # 22 (Input tá»« layer 21)
  - [[-1, 10], 1, BiFPN, [512]]                  # 23 (Há»£p nháº¥t: P4-up, Backbone P5)
  - [-1, 2, C3k2, [1024, True]]                  # 24 -> Detect P5 (Large objects)

  # Detect
  # Layer 17 (P3), Layer 21 (P4), Layer 24 (P5)
  - [[17, 21, 24], 1, Detect, [nc]]